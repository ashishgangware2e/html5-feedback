/*! jQuery-ui-Slider-Pips - v1.11.3 - 2016-03-15
* Copyright (c) 2016 Simon Goellner <simey.me@gmail.com>; Licensed MIT */
!function($){"use strict";var extensionMethods={pips:function(settings){var slider=this,i,j,p,collection="",mousedownHandlers,min=slider._valueMin(),max,pips=(slider._valueMax()-min)/slider.options.step,$handles=slider.element.find(".ui-slider-handle"),$pips,options={first:"label",last:"label",rest:"pip",labels:!1,prefix:"",suffix:"",step:pips>100?Math.floor(.05*pips):1,formatLabel:function(value){return this.prefix+value+this.suffix}};if("object"===$.type(settings)||"undefined"===$.type(settings)){$.extend(options,settings),slider.element.data("pips-options",options),slider.options.pipStep=Math.abs(Math.round(options.step))||1,slider.element.off(".selectPip").addClass("ui-slider-pips").find(".ui-slider-pip").remove();var selectPip={single:function(value){this.resetClasses(),$pips.filter(".ui-slider-pip-"+this.classLabel(value)).addClass("ui-slider-pip-selected"),slider.options.range&&$pips.each((function(k,v){var pipVal=$(v).children(".ui-slider-label").data("value");("min"===slider.options.range&&pipVal<value||"max"===slider.options.range&&pipVal>value)&&$(v).addClass("ui-slider-pip-inrange")}))},range:function(values){for(this.resetClasses(),i=0;i<values.length;i++)$pips.filter(".ui-slider-pip-"+this.classLabel(values[i])).addClass("ui-slider-pip-selected-"+(i+1));slider.options.range&&$pips.each((function(k,v){var pipVal=$(v).children(".ui-slider-label").data("value");pipVal>values[0]&&pipVal<values[1]&&$(v).addClass("ui-slider-pip-inrange")}))},classLabel:function(value){return value.toString().replace(".","-")},resetClasses:function(){var regex=/(^|\s*)(ui-slider-pip-selected|ui-slider-pip-inrange)(-{1,2}\d+|\s|$)/gi;$pips.removeClass((function(index,css){return(css.match(regex)||[]).join(" ")}))}};for(collection+=createPip("first"),p=slider.options.pipStep;p<pips;p+=slider.options.pipStep)collection+=createPip(p);for(collection+=createPip("last"),slider.element.append(collection),$pips=slider.element.find(".ui-slider-pip"),mousedownHandlers=$._data(slider.element.get(0),"events").mousedown&&$._data(slider.element.get(0),"events").mousedown.length?$._data(slider.element.get(0),"events").mousedown:slider.element.data("mousedown-handlers"),slider.element.data("mousedown-handlers",mousedownHandlers.slice()),j=0;j<mousedownHandlers.length;j++)"slider"===mousedownHandlers[j].namespace&&slider.element.data("mousedown-original",mousedownHandlers[j].handler);slider.element.off("mousedown.slider").on("mousedown.selectPip",(function(e){var $target=$(e.target),closest=getClosestHandle($target.data("value")),$handle=$handles.eq(closest),originalMousedown;($handle.addClass("ui-state-active"),$target.is(".ui-slider-label"))?(labelClick($target,e),slider.element.one("mouseup.selectPip",(function(){$handle.removeClass("ui-state-active").focus()}))):slider.element.data("mousedown-original")(e)})),slider.element.on("slide.selectPip slidechange.selectPip",(function(e,ui){var $slider=$(this),value=$slider.slider("value"),values=$slider.slider("values");ui&&(value=ui.value,values=ui.values),slider.values()&&slider.values().length?selectPip.range(values):selectPip.single(value)}))}else"destroy"===settings?destroy():"refresh"===settings&&slider.element.slider("pips",slider.element.data("pips-options"));function getClosestHandle(val){var h,k,sliderVals,comparedVals,closestVal,tempHandles=[],closestHandle=0;if(slider.values()&&slider.values().length){for(sliderVals=slider.values(),comparedVals=$.map(sliderVals,(function(v){return Math.abs(v-val)})),closestVal=Math.min.apply(Math,comparedVals),h=0;h<comparedVals.length;h++)comparedVals[h]===closestVal&&tempHandles.push(h);for(closestHandle=tempHandles[0],k=0;k<tempHandles.length;k++)slider._lastChangedValue===tempHandles[k]&&(closestHandle=tempHandles[k]);slider.options.range&&2===tempHandles.length&&(val>sliderVals[1]?closestHandle=tempHandles[1]:val<sliderVals[0]&&(closestHandle=tempHandles[0]))}return closestHandle}function destroy(){slider.element.off(".selectPip").on("mousedown.slider",slider.element.data("mousedown-original")).removeClass("ui-slider-pips").find(".ui-slider-pip").remove()}function labelClick(label,e){if(!slider.option("disabled")){var val=$(label).data("value"),indexToChange=getClosestHandle(val);slider.values()&&slider.values().length?slider.options.values[indexToChange]=slider._trimAlignValue(val):slider.options.value=slider._trimAlignValue(val),slider._refreshValue(),slider._change(e,indexToChange)}}function createPip(which){var label,percent,number=which,classes="ui-slider-pip",css="",value=slider.value(),values=slider.values(),labelValue,classLabel,labelIndex;if("first"===which?number=0:"last"===which&&(number=pips),classLabel=(labelValue=min+slider.options.step*number).toString().replace(".","-"),labelIndex=Math.round((number-min)/options.step),label="array"===$.type(options.labels)?options.labels[labelIndex]||"":"object"===$.type(options.labels)?"first"===which?options.labels.first||"":"last"===which?options.labels.last||"":"array"===$.type(options.labels.rest)?options.labels.rest[labelIndex-1]||"":labelValue:labelValue,"first"===which?(percent="0%",classes+=" ui-slider-pip-first",classes+="label"===options.first?" ui-slider-pip-label":"",classes+=!1===options.first?" ui-slider-pip-hide":""):"last"===which?(percent="100%",classes+=" ui-slider-pip-last",classes+="label"===options.last?" ui-slider-pip-label":"",classes+=!1===options.last?" ui-slider-pip-hide":""):(percent=(100/pips*which).toFixed(4)+"%",classes+="label"===options.rest?" ui-slider-pip-label":"",classes+=!1===options.rest?" ui-slider-pip-hide":""),classes+=" ui-slider-pip-"+classLabel,values&&values.length){for(i=0;i<values.length;i++)labelValue===values[i]&&(classes+=" ui-slider-pip-initial-"+(i+1),classes+=" ui-slider-pip-selected-"+(i+1));slider.options.range&&labelValue>values[0]&&labelValue<values[1]&&(classes+=" ui-slider-pip-inrange")}else labelValue===value&&(classes+=" ui-slider-pip-initial",classes+=" ui-slider-pip-selected"),slider.options.range&&("min"===slider.options.range&&labelValue<value||"max"===slider.options.range&&labelValue>value)&&(classes+=" ui-slider-pip-inrange");return'<span class="'+classes+'" style="'+(css="horizontal"===slider.options.orientation?"left: "+percent:"bottom: "+percent)+'"><span class="ui-slider-line"></span><span class="ui-slider-label" data-value="'+labelValue+'">'+options.formatLabel(label)+"</span></span>"}},float:function(settings){var i,slider=this,min=slider._valueMin(),max=slider._valueMax(),value=slider._value(),values=slider._values(),tipValues=[],$handles=slider.element.find(".ui-slider-handle"),options={handle:!0,pips:!1,labels:!1,prefix:"",suffix:"",event:"slidechange slide",formatLabel:function(value){return this.prefix+value+this.suffix}};if("object"===$.type(settings)||"undefined"===$.type(settings)){if($.extend(options,settings),slider.element.data("float-options",options),value<min&&(value=min),value>max&&(value=max),values&&values.length)for(i=0;i<values.length;i++)values[i]<min&&(values[i]=min),values[i]>max&&(values[i]=max);if(slider.element.addClass("ui-slider-float").find(".ui-slider-tip, .ui-slider-tip-label").remove(),options.handle)for(tipValues=slider.values()&&slider.values().length?getPipLabels(values):getPipLabels([value]),i=0;i<tipValues.length;i++)$handles.eq(i).append($('<span class="ui-slider-tip">'+options.formatLabel(tipValues[i])+"</span>"));options.pips&&slider.element.find(".ui-slider-label").each((function(k,v){var $this=$(v),val=[$this.data("value")],label,$tip;label=options.formatLabel(getPipLabels(val)[0]),$tip=$('<span class="ui-slider-tip-label">'+label+"</span>").insertAfter($this)})),"slide"!==options.event&&"slidechange"!==options.event&&"slide slidechange"!==options.event&&"slidechange slide"!==options.event&&(options.event="slidechange slide"),slider.element.off(".sliderFloat").on(options.event+".sliderFloat",(function(e,ui){var uiValue="array"===$.type(ui.value)?ui.value:[ui.value],val=options.formatLabel(getPipLabels(uiValue)[0]);$(ui.handle).find(".ui-slider-tip").html(val)}))}else"destroy"===settings?destroy():"refresh"===settings&&slider.element.slider("float",slider.element.data("float-options"));function destroy(){slider.element.off(".sliderFloat").removeClass("ui-slider-float").find(".ui-slider-tip, .ui-slider-tip-label").remove()}function getPipLabels(values){var vals=[],steppedVals=$.map(values,(function(v){return Math.ceil((v-min)/slider.options.step)}));if("array"===$.type(options.labels))for(i=0;i<values.length;i++)vals[i]=options.labels[steppedVals[i]]||values[i];else if("object"===$.type(options.labels))for(i=0;i<values.length;i++)values[i]===min?vals[i]=options.labels.first||min:values[i]===max?vals[i]=options.labels.last||max:"array"===$.type(options.labels.rest)?vals[i]=options.labels.rest[steppedVals[i]-1]||values[i]:vals[i]=values[i];else for(i=0;i<values.length;i++)vals[i]=values[i];return vals}}};$.extend(!0,$.ui.slider.prototype,extensionMethods)}(jQuery);